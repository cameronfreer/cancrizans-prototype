"""
Generate comprehensive educational documentation automatically.
This script creates lesson plans, tutorials, and educational markdown files.
"""

from pathlib import Path
from datetime import datetime


def generate_lesson_plan_md() -> str:
    """Generate lesson plan markdown documentation."""
    return """# Crab Canon Lesson Plans

> Auto-generated educational materials for teaching palindromic music
> Generated: {timestamp}

## Overview

These lesson plans introduce students to crab canons (canon cancrizans) through
Bach's famous example from *The Musical Offering* (BWV 1079).

---

## Lesson 1: Introduction to Palindromes (30 minutes)

### Learning Objectives
- Understand what a palindrome is
- Recognize palindromes in language and music
- Identify forward vs. backward motion

### Materials Needed
- Cancrizans web application
- Examples of word palindromes
- Audio playback capability

### Lesson Plan

**1. Word Palindromes (5 minutes)**
- Show examples: "racecar", "A man, a plan, a canal: Panama"
- Students identify what makes them special
- Discussion: "What would a musical palindrome be?"

**2. Musical Palindromes (10 minutes)**
- Explain retrograde motion in music
- Play a simple melody forward and backward
- Introduce the concept of simultaneous forward/backward

**3. Bach's Crab Canon (10 minutes)**
- Open Cancrizans web app
- Play Bach's example (both voices together)
- Mute voices individually to hear each direction
- Show mirror view visualization

**4. Discussion (5 minutes)**
- How does it sound? Is it beautiful?
- Why is it called "crab" canon?
- What makes this compositionally challenging?

### Assessment
- Students explain palindrome concept in their own words
- Students identify which voice is forward vs. backward
- Exit ticket: "Why is a crab canon harder than a regular canon?"

---

## Lesson 2: Creating Your Own Canon (45 minutes)

### Learning Objectives
- Compose a simple melodic theme
- Understand how retrograde works
- Create and perform a crab canon

### Materials Needed
- Cancrizans web application (composer tool)
- Staff paper (optional)
- Pencils

### Lesson Plan

**1. Review (5 minutes)**
- Recap palindrome concept from Lesson 1
- Quick listen to Bach's canon

**2. Composing a Theme (15 minutes)**
- Open the Interactive Canon Builder
- Demonstrate: click to add notes
- Students create 4-8 note melody
- Keep it simple: stepwise motion, simple rhythms

**3. Automatic Retrograde (10 minutes)**
- Show how red notes appear automatically
- Explain: computer generates the backward voice
- Play the canon to hear both voices

**4. Refinement (10 minutes)**
- Students adjust their melodies
- Listen for harmony and consonance
- Try different templates for inspiration

**5. Performance & Sharing (5 minutes)**
- Students play their canons for class
- Discussion: Which ones sound best? Why?

### Assessment
- Students successfully create a working crab canon
- Can explain how retrograde is generated
- Peer evaluation of compositions

---

## Lesson 3: Analysis & History (30 minutes)

### Learning Objectives
- Understand historical context of The Musical Offering
- Analyze harmonic structure of crab canons
- Recognize contrapuntal techniques

### Materials Needed
- Cancrizans analysis tools
- Historical information about Bach
- Score/notation view

### Lesson Plan

**1. Historical Context (10 minutes)**
- Frederick the Great's musical challenge to Bach
- The Musical Offering collection
- Puzzle canons and musical riddles of the Baroque

**2. Musical Analysis (15 minutes)**
- Use CLI analysis tools (if available)
- Examine consonance/dissonance ratios
- Interval analysis: what intervals does Bach use?
- Rhythm analysis: note duration patterns

**3. Compositional Techniques (5 minutes)**
- How did Bach ensure it sounds good both ways?
- Symmetry in harmony
- Voice leading principles

### Assessment
- Students identify 3 facts about The Musical Offering
- Can explain one contrapuntal technique Bach uses
- Written reflection on Bach's compositional skill

---

## Lesson 4: Advanced Exploration (45 minutes)

### Learning Objectives
- Explore other canon types (augmentation, diminution)
- Compare multiple crab canons
- Create variations on Bach's theme

### Materials Needed
- Cancrizans CLI research tools
- Examples directory with multiple canons
- Composer tool

### Lesson Plan

**1. Canon Types (15 minutes)**
- Demonstrate augmentation (slower retrograde)
- Demonstrate diminution (faster retrograde)
- Show mirror canon (retrograde + inversion)
- Listen to examples 06-10

**2. Comparative Analysis (15 minutes)**
- Use research command to analyze all examples
- Compare consonance ratios
- Which canons are more/less harmonious?
- Statistical patterns across the corpus

**3. Creative Variations (10 minutes)**
- Students create variations on Bach's theme
- Try transposing (change key)
- Apply augmentation/diminution
- Combine with inversion

**4. Reflection (5 minutes)**
- What did we learn about palindromic music?
- How has technology changed music education?
- Where else do we see mathematical patterns in music?

### Assessment
- Students create one canon variation
- Can explain difference between canon types
- Final project: Research presentation on canons

---

## Extension Activities

### For Advanced Students
1. **Composition Challenge**: Create a crab canon that is also invertible
2. **Research Project**: Find other composers who used crab canons
3. **Programming**: Modify the code to create new visualizations

### For Struggling Students
1. **Guided Composition**: Use templates, modify just one or two notes
2. **Visual Learning**: Focus on mirror view, trace symmetry
3. **Pattern Recognition**: Identify repeated patterns in Bach's canon

### Cross-Curricular Connections
- **Mathematics**: Symmetry, transformations, group theory
- **Computer Science**: Algorithms, recursion, data structures
- **Language Arts**: Palindromes, poetic structure
- **Art**: Visual symmetry, mirror images

---

## Assessment Rubric

### Crab Canon Composition (100 points)

| Criterion | Excellent (25pts) | Proficient (20pts) | Developing (15pts) | Needs Work (10pts) |
|-----------|------------------|-------------------|-------------------|-------------------|
| **Musical Quality** | Beautiful harmony, interesting melody | Generally pleasant, some good moments | Functional but bland | Many dissonances, unclear |
| **Technical Accuracy** | Perfect palindrome, correct retrograde | Minor timing issues | Several errors | Does not function as canon |
| **Creativity** | Highly original, takes risks | Some original elements | Mostly template-based | Direct copy of example |
| **Understanding** | Can explain all concepts clearly | Understands most concepts | Some confusion | Little understanding |

### Total: ____ / 100

---

## Resources

### Online Tools
- **Cancrizans Web App**: Interactive exploration
- **Cancrizans CLI**: Advanced analysis for research

### Further Reading
- Hofstadter, Douglas R. *Gödel, Escher, Bach*
- Wolff, Christoph. *Johann Sebastian Bach: The Learned Musician*
- Marissen, Michael. *The Social and Religious Designs of J.S. Bach's Brandenburg Concertos*

### Videos & Media
- Search YouTube for "Bach Crab Canon visualization"
- Listen to historically informed performances
- Watch documentaries about The Musical Offering

---

## Standards Alignment

### National Core Arts Standards (Music)
- **Creating (MU:Cr1.1)**: Generate musical ideas
- **Performing (MU:Pr4.2)**: Analyze structure of musical works
- **Responding (MU:Re7.2)**: Describe how elements support creator's intent
- **Connecting (MU:Cn11.0)**: Relate musical ideas to other subjects

### Common Core (Mathematics)
- **CCSS.MATH.PRACTICE.MP7**: Look for and make use of structure
- **CCSS.MATH.CONTENT.HSG.CO.A.3**: Describe symmetries

### ISTE Standards (Technology)
- **Creative Communicator**: Create with digital tools
- **Innovative Designer**: Use digital tools to create knowledge
- **Computational Thinker**: Understand how technology works

---

*Generated by the Cancrizans project - https://github.com/cancrizans-prototype*
*Last updated: {timestamp}*
""".format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S'))


def generate_tutorial_guide_md() -> str:
    """Generate web tutorial guide markdown."""
    return """# Interactive Tutorial Guide

> Step-by-step learning path for the Cancrizans web application
> Generated: {timestamp}

## Getting Started

The Cancrizans web app includes an interactive tutorial system that guides you
through understanding crab canons. This document outlines the tutorial flow.

---

## Tutorial Steps Overview

### Step 1: Welcome
**Goal**: Introduce the concept of crab canons

Students learn:
- What a crab canon is (musical palindrome)
- That Bach's example is from The Musical Offering
- The tutorial will be interactive and hands-on

### Step 2: Musical Palindromes
**Goal**: Understand the palindrome concept

Students learn:
- Comparison to word palindromes
- Voice 1 = forward, Voice 2 = backward
- Both start simultaneously

### Step 3: Listen
**Goal**: Hear the canon in action

**Action Required**: Click the Play button

Students observe:
- How both voices create harmony
- The sound of temporal symmetry
- Forward and backward motion simultaneously

### Step 4: Visualize Symmetry
**Goal**: See the palindrome structure

Focus on: **Mirror View canvas**

Students observe:
- Blue = Voice 1 (forward)
- Red = Voice 2 (backward)
- Center line = the "mirror"
- Perfect symmetry

### Step 5: Musical Notation
**Goal**: Read traditional notation

Focus on: **Notation container**

Students learn:
- Two staves show both voices
- Voice 2 would be read right-to-left
- Traditional notation of puzzle canons

### Step 6: Tempo Control
**Goal**: Experiment with speed

**Action Required**: Adjust tempo slider

Students discover:
- Slower = easier to hear symmetry
- Faster = more exciting
- Bach's intended tempo: ~84 BPM

### Step 7: Isolate Voices
**Goal**: Hear each voice independently

**Action Required**: Toggle mute checkboxes

Students practice:
- Mute Voice 2 → hear forward melody
- Mute Voice 1 → hear retrograde
- Understand each voice's character

### Step 8: Composer Introduction
**Goal**: Prepare to create own canon

Focus on: **Canon Builder section**

Students learn:
- Click to add notes
- Drag to move notes
- Shift+click to delete
- Red notes = automatic retrograde

### Step 9: Templates
**Goal**: Start with pre-made example

**Action Required**: Select and play template

Students explore:
- Different melodic shapes
- How templates become canons
- Inspiration for own compositions

### Step 10: Experiment
**Goal**: Create original canon

**Action Required**: Compose and play own melody

Students practice:
- Independent composition
- Trial and error
- Listening critically

### Step 11: Completion
**Goal**: Review and celebrate

Students reflect on:
- Key concepts learned
- Crab canon = musical palindrome
- Two voices in opposite directions
- Bach's compositional genius

---

## Teaching Tips

### Before Starting Tutorial
1. Ensure audio is working
2. Demo the play button first
3. Set expectations: "Follow the prompts"

### During Tutorial
- Let students work at their own pace
- Encourage experimentation in Step 10
- Circulate to help struggling students
- Ask reflection questions between steps

### After Tutorial
- Class discussion: "What was your favorite part?"
- Share created canons
- Connect to broader music history
- Assign follow-up composition homework

---

## Common Issues & Solutions

### Issue: Tutorial won't start
**Solution**: Refresh page, check JavaScript console

### Issue: Audio not playing
**Solution**:
- Check browser permissions
- Click anywhere first (Chrome requirement)
- Try different browser

### Issue: Can't hear symmetry
**Solution**:
- Slow down tempo to 60 BPM
- Mute voices individually first
- Try with headphones

### Issue: Composer tool confusing
**Solution**:
- Start with Step 9 (templates)
- Watch teacher demo first
- Pair students for peer learning

---

## Extensions

### For Quick Learners
- Skip to composer immediately
- Challenge: Create canon with 12+ notes
- Try creating an invertible canon

### For Struggling Learners
- Repeat Steps 1-7 multiple times
- Focus on listening, not creating
- Use only templates (skip free composition)

### Class Activities
- **Canon Gallery**: Display all student canons
- **Performance**: Each student plays their canon
- **Peer Review**: Rate each other's compositions
- **Research**: Find other crab canons in music history

---

## Assessment Ideas

### Formative Assessment (During Tutorial)
- Observe: Can student navigate independently?
- Ask: "Explain what a retrograde is"
- Check: Can student create a simple canon?

### Summative Assessment (After Tutorial)
1. **Listening Test**: Play canon, identify voices
2. **Composition**: Create original crab canon
3. **Written Reflection**: Explain concept in essay
4. **Presentation**: Share canon with class

### Rubric Criteria
- Technical Understanding (25%)
- Musical Quality (25%)
- Creativity (25%)
- Engagement & Effort (25%)

---

## Integration with Lesson Plans

The tutorial complements the 4-lesson sequence:

- **Lesson 1**: Complete Steps 1-4 (introduction)
- **Lesson 2**: Steps 8-10 (composition)
- **Lesson 3**: Revisit Steps 5-7 (analysis)
- **Lesson 4**: Independent exploration (no tutorial)

---

## Technical Requirements

### Minimum Requirements
- Modern web browser (Chrome, Firefox, Safari, Edge)
- JavaScript enabled
- Audio output
- Mouse or touchscreen

### Recommended Setup
- Desktop or tablet (easier than phone)
- Headphones or speakers
- Quiet environment
- 1280x720 or larger screen

### Accessibility Features
- Keyboard navigation support
- Screen reader compatible
- High contrast mode available
- Adjustable text size

---

*Generated by the Cancrizans project*
*For support, see: https://github.com/cancrizans-prototype/issues*
*Last updated: {timestamp}*
""".format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S'))


def generate_quiz_questions_md() -> str:
    """Generate quiz/assessment questions."""
    return """# Crab Canon Quiz Bank

> Assessment questions for testing student understanding
> Generated: {timestamp}

---

## Multiple Choice Questions

### Beginner Level

**Question 1**: What is a crab canon?
- A) A song about crabs
- B) A musical palindrome where a melody plays forward and backward simultaneously ✓
- C) A canon written for the ocean
- D) A type of crab found in music halls

**Question 2**: In Bach's Crab Canon, what is Voice 2?
- A) A completely different melody
- B) The same melody played faster
- C) The exact time-reversal of Voice 1 ✓
- D) Voice 1 played in a different key

**Question 3**: What does "retrograde" mean in music?
- A) Playing notes in reverse order (backward in time) ✓
- B) Playing notes louder
- C) Playing notes in a different key
- D) Playing notes faster

**Question 4**: What is The Musical Offering?
- A) A collection of pieces Bach wrote for Frederick the Great ✓
- B) A book about music
- C) A concert hall
- D) A type of instrument

**Question 5**: Why is it called a "crab" canon?
- A) Bach loved seafood
- B) Crabs walk sideways/backward ✓
- C) It was written near the ocean
- D) The music sounds like crabs

### Intermediate Level

**Question 6**: What must be true for a piece to be a true time-palindrome?
- A) Both voices start at different times
- B) Voice 2 starts when Voice 1 ends ✓ (false - they start together!)
- C) Both voices play the exact same rhythm and pitch in reverse ✓
- D) Only the rhythm is reversed

**Question 7**: In the Cancrizans visualization, what does the mirror view show?
- A) Only Voice 1
- B) Only Voice 2
- C) Both voices with symmetry around a center line ✓
- D) The composer's reflection

**Question 8**: What compositional challenge does a crab canon present?
- A) Making both forward and backward versions sound harmonious ✓
- B) Writing very fast music
- C) Using many instruments
- D) Making it very loud

**Question 9**: Which of these is NOT a type of canon?
- A) Augmentation canon (one voice slower)
- B) Diminution canon (one voice faster)
- C) Mirror canon (retrograde + inversion)
- D) Helicopter canon ✓

**Question 10**: What is inversion in music?
- A) Playing upside down
- B) Flipping pitches: up becomes down, down becomes up ✓
- C) Playing backward
- D) Playing twice as fast

### Advanced Level

**Question 11**: What is a mirror canon?
- A) Retrograde only
- B) Inversion only
- C) Both retrograde AND inversion combined ✓
- D) A canon about mirrors

**Question 12**: What does augmentation mean in canon technique?
- A) Making the melody louder
- B) Multiplying note durations (slower) ✓
- C) Adding more notes
- D) Playing higher pitches

**Question 13**: In the research analysis, what is "consonance ratio"?
- A) How many notes are consonant vs. dissonant ✓
- B) How loud the music is
- C) How fast the tempo is
- D) How many voices there are

**Question 14**: What interval is most common in Bach's Crab Canon?
- A) Octaves
- B) Perfect fifths
- C) Major seconds (whole steps) ✓ (approximately)
- D) Minor sevenths

**Question 15**: What makes a crab canon especially difficult to compose?
- A) It must sound good played both forward AND backward ✓
- B) It requires many instruments
- C) It must be very long
- D) It must be in a minor key

---

## True/False Questions

1. **T** / F: A crab canon is a type of musical palindrome
2. T / **F**: Voice 2 starts when Voice 1 finishes (Both start together!)
3. **T** / F: Bach wrote the Crab Canon as part of The Musical Offering
4. **T** / F: Retrograde means playing a melody backward in time
5. T / **F**: All canons must have exactly two voices (Can have more!)
6. **T** / F: The Cancrizans web app can automatically generate the retrograde voice
7. T / **F**: A crab canon and a round are the same thing (Different!)
8. **T** / F: Augmentation makes note durations longer (slower)
9. **T** / F: Diminution makes note durations shorter (faster)
10. T / **F**: You need to be a professional musician to create a simple crab canon (No!)

---

## Short Answer Questions

1. **Define "retrograde" in your own words.**
   - *Expected answer*: Playing a melody backward in time, starting from the end and going to the beginning

2. **Explain why a crab canon is called a "palindrome."**
   - *Expected answer*: Like a word palindrome that reads the same forwards and backwards, a crab canon sounds the same when played in both directions

3. **Describe what happens in Bach's Crab Canon.**
   - *Expected answer*: Voice 1 plays the melody forward while Voice 2 plays the exact same melody backward, both starting at the same time

4. **What is the difference between retrograde and inversion?**
   - *Expected answer*: Retrograde reverses time (backward), inversion flips pitches (up/down reversed)

5. **Name two ways to vary a canon theme.**
   - *Expected answers*: Augmentation (slower), diminution (faster), transposition (different key), inversion (flipped pitches), etc.

---

## Essay/Discussion Questions

1. **Why do you think Bach created puzzle canons like the Crab Canon? What purpose did they serve?**

2. **Describe the mathematical relationship between the two voices in a crab canon. Use the terms "symmetry" and "transformation."**

3. **Compare and contrast a crab canon with a traditional round (like "Row, Row, Row Your Boat"). How are they similar? How are they different?**

4. **Explain how technology (like the Cancrizans app) changes the way we learn about and create crab canons compared to Bach's time.**

5. **If you were to explain crab canons to a younger student, what example or analogy would you use?**

---

## Performance-Based Assessment

### Composition Task
**Create a crab canon that:**
- Has at least 6 notes
- Uses at least 2 different note durations
- Sounds harmonious when both voices play together
- Is a true palindrome (verified by the app)

### Analysis Task
**Listen to Bach's Crab Canon and identify:**
- Where the melodic high point is
- What interval occurs most frequently
- Whether the harmony is mostly consonant or dissonant
- What tempo makes the symmetry most audible

### Presentation Task
**Prepare a 3-minute presentation that:**
- Explains what a crab canon is
- Demonstrates using the Cancrizans web app
- Plays your original composition
- Describes one interesting thing you learned

---

## Answer Key Summary

### Multiple Choice
1. B, 2. C, 3. A, 4. A, 5. B
6. C, 7. C, 8. A, 9. D, 10. B
11. C, 12. B, 13. A, 14. C, 15. A

### True/False
1. T, 2. F, 3. T, 4. T, 5. F
6. T, 7. F, 8. T, 9. T, 10. F

---

## Grading Rubric for Essays

| Criterion | Excellent (4) | Good (3) | Fair (2) | Poor (1) |
|-----------|--------------|----------|----------|----------|
| **Understanding** | Demonstrates deep understanding | Shows solid grasp | Some understanding | Little understanding |
| **Examples** | Uses specific, relevant examples | Good examples | Few examples | No examples |
| **Organization** | Clear, logical structure | Generally organized | Some organization | Disorganized |
| **Depth** | Analyzes beyond surface level | Some analysis | Mostly description | Superficial |

---

*Generated by the Cancrizans project*
*For more assessment ideas, see LESSON_PLANS.md*
*Last updated: {timestamp}*
""".format(timestamp=datetime.now().strftime('%Y-%m-%d %H:%M:%S'))


def main():
    """Generate all educational documentation."""
    print("Generating educational documentation...")
    print("=" * 60)

    # Create output directory
    output_dir = Path('docs')
    output_dir.mkdir(exist_ok=True)

    # Generate lesson plans
    lesson_plan_path = output_dir / 'LESSON_PLANS.md'
    with open(lesson_plan_path, 'w') as f:
        f.write(generate_lesson_plan_md())
    print(f"✓ Generated: {lesson_plan_path}")

    # Generate tutorial guide
    tutorial_path = output_dir / 'TUTORIAL_GUIDE.md'
    with open(tutorial_path, 'w') as f:
        f.write(generate_tutorial_guide_md())
    print(f"✓ Generated: {tutorial_path}")

    # Generate quiz bank
    quiz_path = output_dir / 'QUIZ_BANK.md'
    with open(quiz_path, 'w') as f:
        f.write(generate_quiz_questions_md())
    print(f"✓ Generated: {quiz_path}")

    print()
    print("=" * 60)
    print("Educational documentation generation complete!")
    print()
    print(f"Generated files:")
    print(f"  - {lesson_plan_path} (4 complete lesson plans)")
    print(f"  - {tutorial_path} (Interactive tutorial guide)")
    print(f"  - {quiz_path} (Quiz questions & assessments)")
    print()
    print("These files are ready for use in educational settings!")


if __name__ == '__main__':
    main()
